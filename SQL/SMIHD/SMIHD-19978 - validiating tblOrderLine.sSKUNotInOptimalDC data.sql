--  SMIHD-19978 - validiating tblOrderLine.sSKUNotInOptimalDC data

-- flgUpsell

-- As of 3-16-21 Connie hasn't installed the changes yet.
-- the stored proc is already using @flgUpsell, so will just need to refeed and verify values are updating.

select ixOrder, ixSKU, flgUpsell, dtDateLastSOPUpdate, ixTimeLastSOPUpdate
from tblOrderLine
where ixOrder in ('10867703','10812707' )
and ixSKU in ('91033046','91025617')

select flgUpsell, count(1) 'OrderLineCbt', count(distinct ixOrder) 'OrderCnt'
from tblOrderLine
where ixOrderDate >= 19419--	03/01/2021
group by flgUpsell
/*
flgUpsell	OrderLineCbt	OrderCnt
1	        132	            102
0	        200249	        62576
*/










set rowcount 0  

BEGIN TRAN

    UPDATE tblOrderLine
    SET sSKUNotInOptimalDC = null
    where sSKUNotInOptimalDC  is not NULL --= '0'

ROLLBACK TRAN

    SELECT count(1)
    FROM tblOrderLine
    where sSKUNotInOptimalDC is NOT NULL -- = '0' -- 19,506

select sSKUNotInOptimalDC, distinct(ixOrder) 'OrderLineCount'
from tblOrderLine
group by sSKUNotInOptimalDC
order by count(1) desc

select sSKUNotInOptimalDC, COUNT(distinct(ixOrder)) 'OrderLineCount'
from tblOrderLine
where sSKUNotInOptimalDC is NOT NULL
group by sSKUNotInOptimalDC
order by count(1) desc
/*
AFCO
=====
QAV	6


SMI
=====
BKR	1
DLR	20
MKT	1
QAV	4

*/



    select ixOrder, ixSKU, sSKUNotInOptimalDC
    from tblOrderLine
    --SET sSKUNotInOptimalDC = null
    where sSKUNotInOptimalDC  is not NULL --= '0'




select --count(1) -- 3,608
-- DROP TABLE #AllNullOptimalDCflags
    ixOrder, ixOptimalShipLocation, ixPrimaryShipLocation
INTO #AllNullOptimalDCflags
from tblOrder 
where ixOrder in ('9732199','9367198','9717492','9700496','9783390','9747291','9781290','9734495','9766394','9717499','9730491','9779197','9777097','9713495','9779393','9730498','9709491','9796396','9726494','9709498','9741397','9788192','9775396','9773296','9722490','9792399','9722497','9754396','9701490','9788395','9750392','9701497','9784391','9735496','9767395','9784398','9782298','9731492','9729392','9797390','9714496','9746395','9731499','9763398','9710492','9797397','9761298','9795297','9776390','9727495','9759394','9710499','9742398','9776397','9772393','9723498','9770293','9789396','9702491','9736490','9734390','9732290','9719494','9751393','9785392','9736497','9734397','9768396','9715490','9732493','9730393','9798391','9747396','9781395','9764399','9798398','9711493','9743392','9728496','9743399','9724492','9756391','9707496','9739395','9773394','9724499','9737491','9788297','9735391','9769390','9720495','9703499','9786393','9735398','9716491','9746290','9731394','9765393','9799392','9716498','9748397','9729490','9799399','9712494','9797299','9729497','9727397','9708490','9795395','9706390','9725493','9757392','9708497','9787191','9736196','9757399','9704493','9791398','9721496','9753395','9713397','9790397','9753297','9723393','9770097','9732297','9771091','9772099','9777391','9703198','9553391','9700195','9700293','9700391','9700398','9701196','9701294','9701392','9701399','9702190','9702197','9702295','9702393','9702498','9703093','9703296','9703394','9703492','9704192','9704290','9704297','9704395','9705291','9705298','9705396','9705494','9706194','9706292','9706299','9706397','9707293','9707391','9707398','9708196','9708294','9708392','9708399','9709190','9709197','9709295','9709393','9710191','9710296','9710394','9711192','9711290','9711297','9711395','9712095','9712291','9712298','9712396','9713194','9713292','9713299','9713390','9714195','9714293','9714391','9714398','9715196','9715294','9715392','9715399','9715497','9716190','9716197','9716295','9716393','9717191','9717198','9717296','9717394','9718192','9718199','9718290','9718297','9718395','9718493','9719193','9719291','9719298','9719396','9720194','9720292','9720299','9720390','9720397','9721195','9721293','9721391','9721398','9722196','9722294','9722392','9722399','9723190','9723197','9723295','9724191','9724198','9724296','9724394','9725192','9725199','9725290','9725297','9725395','9726095','9726193','9726291','9726298','9726396','9727194','9727292','9727299','9727390','9728195','9728293','9728391','9728398','9729196','9729294','9729399','9730092','9730190','9730197','9730295','9731191','9731198','9731296','9732192','9732395','9733193','9733291','9733298','9733396','9734194','9734292','9734299','9735195','9735293','9736294','9736392','9736399','9737099','9737190','9737197','9737295','9737393','9738191','9738198','9738296','9738394','9739192','9739199','9739290','9739297','9740193','9740291','9740298','9740396','9741194','9741292','9741299','9741390','9742195','9742293','9742391','9743196','9743294','9744190','9744197','9744295','9744393','9745191','9745198','9745296','9745394','9746192','9746199','9746297','9747193','9747298','9748194','9748292','9748299','9748390','9749195','9749293','9749391','9749398','9750196','9750294','9750399','9751190','9751197','9751295','9752191','9752198','9752296','9752394','9753094','9753192','9753199','9753290','9754193','9754291','9754298','9755194','9755292','9755299','9755390','9755397','9756090','9756195','9756293','9756398','9757098','9757196','9757294','9758092','9758099','9758190','9758197','9758295','9758393','9759191','9759198','9759296','9760094','9760192','9760199','9760290','9760297','9760395','9761193','9761291','9761396','9762194','9762292','9762299','9762390','9762397','9763090','9763195','9763293','9763391','9764196','9764294','9764392','9765190','9765197','9765295','9766191','9766198','9766296','9767192','9767199','9767290','9767297','9768193','9768291','9768298','9769096','9769194','9769292','9769299','9769397','9770090','9770195','9770391','9770398','9771098','9771196','9771294','9771392','9771399','9772092','9772190','9772197','9772295','9773191','9773198','9774192','9774199','9774290','9774297','9774395','9775095','9775193','9775291','9775298','9776096','9776194','9776292','9776299','9777090','9777195','9777293','9777398','9778091','9778098','9778196','9778294','9778399','9779190','9779295','9780093','9780191','9780198','9780296','9780394','9781094','9781192','9781199','9781297','9782095','9782193','9782291','9782396','9783096','9783194','9783292','9783299','9783397','9784090','9784097','9784195','9784293','9785091','9785098','9785196','9785294','9785399','9786092','9786099','9786190','9786197','9786295','9787093','9787198','9787296','9787394','9788094','9788199','9788290','9789095','9789193','9789291','9789298','9790096','9790194','9790292','9790299','9790390','9791090','9791097','9791195','9791293','9791391','9792091','9792098','9792294','9792392','9793092','9793295','9793393','9794093','9794296','9794394','9795094','9795290','9796095','9796193','9796291','9796298','9797096','9797194','9797292','9798195','9798293','9799196','9799294','9717493','9749392','9700497','9734496','9732396','9766395','9783398','9730492','9762391','9796390','9713496','9745395','9779394','9730499','9709492','9705292','9726495','9758394','9792393','9741398','9775397','9722491','9754390','9752290','9705495','9737394','9722498','9788396','9735490','9750393','9701498','9784392','9735497','9714490','9731493','9763392','9797391','9714497','9780395','9763399','9797398','9710493','9742392','9776391','9727496','9759395','9776398','9719292','9755391','9772394','9723499','9736491','9768390','9719495','9751394','9702499','9700399','9715491','9747390','9798392','9715498','9747397','9781396','9728490','9798399','9711494','9796299','9741293','9777392','9760396','9794395','9707490','9724493','9722393','9756392','9707497','9739396','9790398','9737492','9735392','9769391','9720496','9752395','9786394','9769398','9716492','9782390','9780290','9733495','9763294','9716499','9799393','9782397','9780297','9729491','9727391','9761390','9712495','9757190','9778393','9729498','9727398','9795396','9708491','9740390','9725494','9791392','9740397','9721490','9791399','9704494','9721497','9787395','9700490','9717290','9758093','9735399','9700392','9780094','9781291','9700196','9700294','9701190','9701197','9701295','9701393','9701491','9702191','9702198','9702296','9702394','9702492','9703192','9703290','9703297','9703395','9703493','9704193','9704291','9704298','9704396','9705194','9705299','9705390','9705397','9706293','9706391','9706398','9706496','9707294','9707392','9707399','9708190','9708197','9708295','9708393','9708498','9709191','9709296','9709394','9709499','9710192','9710199','9710290','9710297','9710395','9711193','9711291','9711298','9711396','9712194','9712292','9712299','9712390','9712397','9713195','9713293','9713391','9713398','9714196','9714294','9714392','9714399','9715190','9715197','9715295','9715393','9716191','9716198','9716296','9716394','9717192','9717199','9717297','9717395','9718193','9718291','9718298','9718396','9718494','9719194','9719299','9719390','9719397','9720195','9720293','9720391','9720398','9721098','9721196','9721294','9721392','9721399','9722190','9722197','9722295','9723093','9723191','9723198','9723296','9723394','9724192','9724199','9724290','9724297','9724395','9725193','9725291','9725298','9725396','9726194','9726292','9726299','9726390','9726397','9727195','9727293','9728196','9728294','9728392','9728399','9729190','9729197','9729295','9729393','9730093','9730191','9730198','9730296','9730394','9731094','9731192','9731199','9731290','9731297','9731395','9732193','9732291','9732298','9732494','9733194','9733292','9733299','9733390','9733397','9734097','9734195','9734293','9734391','9734398','9735196','9735294','9736092','9736190','9736197','9736295','9736393','9737191','9737198','9737296','9738192','9738199','9738290','9738297','9738395','9739193','9739291','9739298','9740194','9740292','9740299','9741090','9741195','9741391','9742196','9742294','9742399','9743190','9743197','9743295','9743393','9744191','9744198','9744296','9744394','9745192','9745199','9745290','9745297','9746193','9746291','9746298','9746396','9747194','9747292','9747299','9748195','9748293','9748391','9748398','9749196','9749294','9749399','9750190','9750197','9750295','9751191','9751198','9751296','9752192','9752199','9752297','9753193','9753291','9753298','9753396','9754194','9754292','9754299','9754397','9755195','9755293','9755398','9756091','9756098','9756196','9756294','9756399','9757197','9757295','9757393','9758191','9758198','9758296','9759192','9759199','9759290','9759297','9760193','9760291','9760298','9761194','9761292','9761299','9761397','9762195','9762293','9762398','9763196','9764190','9764197','9764295','9764393','9765191','9765198','9765296','9765394','9766192','9766199','9766290','9766297','9767095','9767193','9767291','9767298','9767396','9768096','9768194','9768292','9768299','9768397','9769090','9769195','9769293','9770196','9770294','9770392','9770399','9771092','9771190','9771197','9771295','9772093','9772191','9772198','9772296','9773094','9773192','9773199','9773290','9773297','9773395','9774095','9774193','9774291','9774298','9774396','9775096','9775194','9775292','9775299','9775390','9776195','9776293','9777091','9777098','9777196','9777294','9777399','9778092','9778099','9778190','9778197','9778295','9779093','9779191','9779198','9779296','9780192','9780199','9781095','9781193','9781298','9782096','9782194','9782292','9782299','9783090','9783195','9783293','9783391','9784091','9784098','9784196','9784294','9784399','9785092','9785099','9785190','9785197','9785295','9785393','9786093','9786191','9786198','9786296','9787094','9787192','9787199','9787290','9787297','9788193','9788291','9788298','9789194','9789292','9789299','9789390','9789397','9790090','9790195','9790293','9790391','9791091','9791098','9791196','9791294','9792099','9792295','9793296','9793394','9794094','9794290','9794297','9795095','9795291','9795298','9796096','9796292','9796397','9797090','9797097','9797195','9797293','9798098','9798196','9798294','9799092','9799099','9799190','9799197','9799295','9734490','9732390','9717494','9715394','9783392','9700498','9734497','9713490','9798295','9783399','9730493','9762392','9713497','9709493','9796398','9707393','9775391','9726496','9724396','9758395','9722492','9705496','9786290','9771394','9769294','9701492','9786297','9735491','9767390','9735498','9767397','9714491','9799296','9706091','9731494','9714498','9710494','9742393','9776392','9727497','9700190','9723493','9721393','9719293','9755392','9706497','9738396','9702493','9789398','9768391','9719496','9785394','9736499','9732299','9747391','9764394','9798393','9715499','9747398','9781397','9728491','9760390','9711495','9707295','9777393','9728498','9760397','9707491','9794396','9739390','9724494','9790392','9705398','9788292','9786192','9739397','9773396','9735197','9720490','9680191','9703494','9737493','9788299','9769392','9720497','9769399','9716493','9748392','9782391','9780291','9733496','9729296','9765395','9799394','9748399','9729492','9761391','9795390','9712496','9729499','9727399','9761398','9795397','9774390','9708499','9740398','9721491','9753390','9704495','9702395','9736394','9721498','9700491','9787396','9767299','9738291','9702297','9784295','9610898','9610996','9700197','9700295','9700393','9701191','9701198','9701296','9701394','9701499','9702192','9702199','9702290','9703193','9703291','9703298','9703396','9704194','9704292','9704299','9704390','9704397','9705195','9705293','9705391','9706196','9706294','9706392','9706399','9706490','9707190','9707197','9707498','9708191','9708198','9708296','9708394','9708492','9709192','9709199','9709290','9709297','9709395','9710291','9710298','9710396','9711096','9711194','9711292','9711299','9711390','9711397','9712195','9712293','9712391','9712398','9713196','9713294','9713392','9713399','9714190','9714197','9714295','9714393','9715191','9715198','9715296','9715492','9716192','9716199','9716290','9716297','9716395','9717193','9717291','9717298','9717396','9718194','9718292','9718299','9718390','9718397','9718495','9719195','9719391','9719398','9720196','9720294','9720392','9720399','9721190','9721197','9721295','9722191','9722198','9722296','9722394','9723192','9723199','9723290','9723297','9723395','9724193','9724291','9724298','9725194','9725292','9725299','9725390','9725397','9725495','9726195','9726293','9726391','9726398','9727196','9727294','9727392','9728190','9728197','9728295','9728393','9729191','9729198','9729394','9730192','9730199','9730290','9730297','9730395','9731193','9731291','9731298','9731396','9732096','9732194','9732292','9732397','9733195','9733293','9733391','9733398','9734196','9734294','9734392','9734399','9735092','9735190','9735295','9735393','9736191','9736198','9736296','9736492','9737192','9737199','9737290','9737297','9737395','9738193','9738298','9739194','9739292','9740195','9740293','9740391','9741091','9741196','9741294','9741392','9741399','9742190','9742197','9742295','9743191','9743198','9743296','9743394','9744094','9744192','9744199','9744290','9744297','9744395','9745193','9745291','9745298','9745396','9746194','9746292','9746299','9746390','9746397','9747195','9747293','9748091','9748196','9748294','9749190','9749197','9749295','9749393','9750191','9750198','9750296','9750394','9751192','9751199','9751290','9751297','9751395','9752193','9752291','9752298','9752396','9753194','9753292','9753299','9753397','9754195','9754293','9754391','9754398','9755196','9755294','9755399','9756190','9756197','9756295','9756393','9757191','9757198','9757296','9757394','9758094','9758192','9758199','9758290','9758297','9759193','9759291','9759298','9759396','9760194','9760292','9760299','9761195','9761293','9762196','9762294','9762399','9763190','9763197','9763295','9763393','9764191','9764198','9764296','9765192','9765199','9765290','9765297','9766193','9766291','9766298','9766396','9767194','9767292','9768195','9768293','9768398','9769196','9770092','9770099','9770190','9770197','9770295','9770393','9771191','9771198','9771296','9772094','9772192','9772199','9772290','9772297','9772395','9773095','9773193','9773291','9773298','9774096','9774194','9774292','9774299','9774397','9775090','9775097','9775195','9775293','9775398','9776098','9776196','9776294','9776399','9777099','9777190','9777197','9777295','9778093','9778191','9778198','9778296','9778394','9779094','9779192','9779199','9779290','9779297','9779395','9780095','9780193','9780298','9780396','9781096','9781194','9781292','9781299','9781390','9782097','9782195','9782293','9782398','9783098','9783196','9783294','9784190','9784197','9784393','9785191','9785198','9785296','9786199','9786395','9787095','9787193','9787291','9787298','9788096','9788194','9788390','9788397','9789090','9789097','9789195','9789293','9789391','9790091','9790098','9790196','9790294','9790399','9791092','9791190','9791197','9791295','9791393','9792093','9792198','9792296','9793094','9793199','9793290','9793297','9793395','9794095','9794291','9794298','9795096','9795292','9795299','9796090','9796097','9796195','9796293','9796391','9797091','9797098','9797196','9797294','9797392','9797399','9798099','9798190','9798197','9799093','9799191','9799198','9700492','9734491','9766390','9730291','9717495','9749394','9700499','9734498','9713491','9711391','9730494','9713498','9796392','9758193','9745397','9779396','9726490','9737193','9726497','9705490','9792395','9722493','9754392','9788391','9705497','9786291','9703397','9771395','9701493','9799094','9788398','9735492','9716396','9750395','9784394','9735499','9767398','9714492','9765298','9731495','9763394','9797393','9714499','9712399','9727491','9759390','9710495','9776393','9727498','9725398','9759397','9706491','9723494','9789392','9706498','9704398','9785192','9738397','9719490','9789399','9719497','9717397','9751396','9768399','9715493','9747392','9745292','9732496','9798394','9728492','9760391','9711496','9707296','9777394','9739195','9760398','9794397','9707492','9739391','9773390','9737291','9771290','9724495','9756394','9707499','9752194','9773397','9771297','9720491','9718391','9703495','9701395','9737494','9735394','9720498','9752397','9786396','9716494','9733497','9799395','9712490','9782399','9727393','9761392','9795391','9759292','9712497','9744396','9795398','9708493','9774391','9725496','9723396','9757395','9791394','9740399','9774398','9721492','9719392','9753391','9704496','9736395','9770394','9732195','9721499','9730095','9753398','9751298','9761294','9724096','9650890','9770198','9587897','9652990','9700198','9700296','9700394','9701192','9701199','9701290','9701297','9702193','9702291','9702298','9702396','9702494','9703194','9703292','9703299','9703390','9704195','9704293','9704391','9705196','9705294','9705392','9705399','9706190','9706197','9706295','9706393','9707191','9707198','9707394','9708192','9708199','9708290','9708297','9708395','9709193','9709291','9709298','9709396','9709494','9710194','9710292','9710299','9710390','9710397','9711293','9711398','9712294','9712392','9713197','9713295','9713393','9714191','9714198','9714296','9714394','9715192','9715199','9715290','9715297','9715395','9716193','9716291','9716298','9717194','9717292','9717299','9717390','9718195','9718293','9718398','9719196','9719294','9719399','9720190','9720197','9720295','9720393','9721191','9721198','9721296','9721394','9722192','9722199','9722290','9722297','9722395','9723193','9723291','9723298','9724194','9724292','9724299','9724390','9724397','9725195','9725293','9725391','9726196','9726294','9726392','9726399','9727190','9727197','9727295','9728191','9728198','9728296','9728394','9729094','9729192','9729199','9729290','9729297','9729395','9730193','9730298','9730396','9731096',
                  '9731194','9731292','9731299','9731390','9731397','9732293','9732391','9732398','9733196','9733294','9733392','9733399','9734190','9734197','9734295','9734393','9735191','9735198','9735296','9736094','9736192','9736199','9736290','9736297','9737298','9737396','9738096','9738194','9738292','9738299','9738390','9739293','9739398','9740196','9740294','9740392','9741092','9741190','9741197','9741295','9741393','9742191','9742198','9742296','9742394','9743192','9743199','9743290','9743297','9743395','9744193','9744291','9744298','9745194','9745299','9745390','9746097','9746195','9746293','9746391','9746398','9747196','9747294','9747399','9748190','9748197','9748295','9748393','9749191','9749198','9749296','9750192','9750199','9750290','9750297','9751193','9751291','9752292','9752299','9752390','9753195','9753293','9754196','9754294','9754399','9755099','9755190','9755197','9755295','9755393','9756093','9756191','9756198','9756296','9757094','9757192','9757199','9757290','9757297','9758291','9758298','9758396','9759194','9759299','9760097','9760195','9760293','9761091','9761196','9761399','9762092','9762190','9762197','9762295','9762393','9763191','9763198','9763296','9764192','9764199','9764290','9764297','9764395','9765095','9765193','9765291','9765396','9766096','9766194','9766292','9766299','9766397','9767097','9767195','9767293','9767391','9768196','9768294','9768392','9769099','9769190','9769197','9769295','9769393','9770191','9770296','9771192','9771199','9772095','9772193','9772291','9772298','9772396','9773096','9773194','9773292','9773299','9774090','9774097','9774195','9774293','9775091','9775098','9775196','9775294','9775392','9775399','9776092','9776190','9776197','9776295','9777093','9777191','9777198','9777296','9778094','9778192','9778199','9778290','9778297','9778395','9779095','9779193','9779291','9779298','9780096','9780194','9780292','9780299','9780390','9780397','9781090','9781097','9781195','9781293','9781391','9781398','9782196','9782294','9782392','9783092','9783099','9783190','9783197','9783295','9783393','9784191','9784198','9784296','9785094','9785199','9785290','9785297','9785395','9786095','9786193','9786298','9787096','9787194','9787292','9787299','9787390','9787397','9788090','9788097','9788195','9788293','9789091','9789098','9789196','9789294','9790092','9790099','9790190','9790197','9790295','9790393','9791093','9791191','9791198','9791296','9792094','9792192','9792290','9792297','9793095','9793291','9793298','9793396','9794096','9794292','9794299','9794390','9795090','9795195','9795293','9796091','9796098','9796196','9796294','9796399','9797092','9797099','9797190','9797197','9797295','9798093','9798191','9798198','9798296','9799192','9799199','9799290','9799297','9753399','9700493','9734492','9785298','9766391','9717496','9749395','9781294','9734499','9713492','9711392','9730495','9796393','9713499','9777297','9709495','9741394','9775393','9726498','9792396','9722494','9720394','9754393','9788392','9733197','9788399','9735493','9767392','9718497','9750396','9784395','9714493','9712393','9746392','9731496','9797394','9780398','9744299','9727492','9793390','9710496','9742395','9727499','9689496','9772390','9723495','9734191','9755394','9706499','9772397','9719491','9702495','9736494','9719498','9751397','9785396','9781392','9732497','9777192','9798395','9711490','9728493','9777199','9711497','9777395','9760399','9794398','9705393','9739392','9773391','9724496','9756395','9720492','9737495','9735395','9720499','9718399','9752398','9786397','9733491','9716495','9746294','9780293','9733498','9712491','9799396','9729494','9727394','9712498','9708298','9744397','9778396','9725490','9795399','9708494','9706394','9725497','9598293','9791395','9702390','9774399','9721493','9787391','9714395','9756199','9757298','9767294','9771291','9701291','9636898','9686892','9700199','9700290','9700297','9700395','9701193','9701298','9701396','9701494','9702194','9702292','9702299','9702397','9703195','9703293','9703391','9703398','9703496','9704196','9704294','9704392','9704399','9704490','9704497','9705190','9705295','9705491','9705498','9706198','9706296','9706492','9707192','9707199','9707290','9707297','9707395','9707493','9708193','9708291','9708396','9709292','9709299','9709390','9709397','9710293','9710391','9710398','9711196','9711294','9711399','9712092','9712190','9712197','9712295','9713191','9713198','9713296','9713394','9714199','9714290','9714297','9715193','9715291','9715298','9715396','9715494','9716194','9716292','9716299','9716390','9716397','9717195','9717293','9717391','9717398','9718091','9718196','9718294','9718392','9718490','9719190','9719197','9719295','9719393','9720191','9720198','9720296','9721192','9721199','9721290','9721297','9721395','9722193','9722291','9722298','9722396','9723194','9723292','9723299','9723397','9724195','9724293','9724391','9724398','9725196','9725294','9725392','9725399','9726190','9726197','9726295','9726393','9727191','9727198','9727296','9728192','9728199','9728290','9728297','9728395','9729193','9729291','9729298','9729396','9730194','9730292','9730299','9730390','9730397','9731195','9731293','9731391','9731398','9732196','9732294','9732392','9732399','9733190','9733295','9733393','9734198','9734296','9734394','9735192','9735199','9735290','9735297','9736193','9736291','9736298','9736396','9737194','9737292','9737299','9737390','9737397','9738195','9738293','9738391','9738398','9739196','9739294','9739399','9740190','9740197','9740295','9740393','9741191','9741198','9741296','9742192','9742199','9742290','9742297','9743193','9743291','9743298','9743396','9744194','9744292','9744390','9745195','9745293','9745391','9745398','9746196','9746399','9747190','9747197','9747295','9747393','9748191','9748198','9748296','9748394','9749192','9749199','9749290','9749297','9750193','9750291','9750298','9751194','9751292','9751299','9751390','9752195','9752293','9752391','9753196','9753294','9753392','9754092','9754190','9754197','9754295','9755191','9755198','9755296','9756192','9756290','9756297','9757193','9757291','9757396','9758096','9758194','9758292','9758299','9758390','9758397','9759195','9759293','9759391','9759398','9760196','9760294','9760392','9761190','9761197','9761295','9761393','9762093','9762191','9762198','9762296','9762394','9763192','9763199','9763290','9763297','9763395','9764095','9764193','9764291','9764298','9764396','9765194','9765292','9765299','9765390','9765397','9766195','9766293','9766398','9767196','9767399','9768099','9768190','9768197','9768295','9768393','9769191','9769198','9769296','9769394','9770192','9770199','9770290','9770297','9770395','9771193','9771298','9771396','9772096','9772194','9772292','9772299','9773097','9773195','9773293','9774091','9774098','9774196','9774294','9774392','9775092','9775099','9775190','9775197','9775295','9776191','9776198','9776296','9776394','9777094','9777290','9778095','9778193','9778291','9778298','9779096','9779194','9779292','9779299','9779390','9779397','9780090','9780097','9780195','9780391','9781091','9781098','9781196','9781399','9782092','9782099','9782190','9782197','9782295','9782393','9783093','9783191','9783198','9783296','9783394','9784094','9784192','9784199','9784290','9784297','9785193','9785291','9786096','9786194','9786292','9786299','9787090','9787097','9787195','9787293','9787398','9788091','9788098','9788196','9788294','9789092','9789190','9789197','9789295','9789393','9790093','9790191','9790198','9790296','9790394','9791094','9791192','9791290','9791297','9792095','9792291','9792298','9793292','9793299','9793397','9794097','9794293','9794391','9795091','9795098','9795196','9795294','9795392','9796092','9796197','9796295','9797093','9797191','9797198','9797296','9798094','9798192','9798199','9798290','9798297','9799095','9799193','9799291','9799298','9715390','9653699','9700494','9734493','9717497','9518284','9762192','9798291','9766399','9713493','9779391','9730496','9728396','9796394','9745399','9779398','9726492','9724392','9709496','9790290','9741395','9775394','9726499','9724399','9758398','9720199','9705492','9756298','9703392','9737391','9771390','9716195','9705499','9703399','9786293','9737398','9718491','9716391','9735494','9767393','9718498','9750397','9731490','9729390','9731497','9727493','9725393','9759392','9710497','9793391','9742396','9776395','9793398','9706493','9704393','9772391','9723496','9770291','9755395','9719492','9717392','9768198','9751391','9736495','9719499','9785397','9783297','9732491','9715495','9726191','9732498','9730398','9798396','9711491','9743390','9728494','9760393','9711498','9724490','9707494','9739393','9773392','9724497','9703490','9701390','9720493','9718393','9703497','9737496','9701397','9769395','9752399','9733492','9731392','9799390','9748395','9782394','9799397','9744391','9729495','9712499','9795393','9744398','9778397','9725491','9708495','9740394','9738294','9774393','9725498','9723398','9757397','9704491','9721494','9753393','9704498','9717490','9716496','9798095','9726394','9769199','9738392','9785194','9338195','9657493','9700193','9700291','9700298','9700396','9701292','9701299','9701495','9702195','9702293','9702391','9702398','9702496','9703294','9704190','9704197','9704295','9705191','9705296','9705394','9706192','9706199','9706290','9706297','9706395','9707193','9707291','9707298','9707396','9708194','9708292','9708299','9708390','9708397','9709195','9709293','9709391','9709398','9710196','9710294','9710392','9710399','9711190','9711197','9711295','9711393','9712198','9712296','9712394','9712492','9713199','9713290','9713297','9713395','9714193','9714291','9714298','9714396','9714494','9715194','9715292','9715299','9715397','9716293','9716398','9717196','9717294','9717399','9718099','9718190','9718197','9718295','9719191','9719198','9719296','9719394','9720192','9720290','9720297','9720395','9721193','9721291','9721298','9721396','9722194','9722292','9722299','9722390','9722397','9723195','9723293','9723391','9724196','9724294','9725190','9725197','9725295','9726198','9726296','9727192','9727199','9727290','9727297','9727395','9728193','9728291','9728298','9729194','9729292','9729299','9729397','9730195','9730293','9730391','9731196','9731294','9731399','9732092','9732190','9732197','9732295','9732393','9733191','9733198','9733296','9733394','9734094','9734192','9734199','9734290','9734297','9734395','9735193','9735291','9735298','9735396','9736194','9736292','9736299','9736390','9736397','9737195','9737293','9738098','9738196','9738399','9739092','9739190','9739197','9739295','9740191','9740198','9740296','9741192','9741199','9741290','9741297','9742193','9742291','9742298','9743194','9743292','9743299','9743397','9744195','9744293','9745196','9745294','9745392','9746190','9746197','9746295','9746393','9747191','9747198','9747296','9747394','9748192','9748199','9748290','9748297','9749193','9749291','9749298','9749396','9750194','9750292','9750299','9750390','9751195','9751293','9751398','9752196','9752294','9752392','9753099','9753190','9753197','9753295','9754191','9754198','9754296','9754394','9755094','9755192','9755199','9755290','9755297','9756193','9756291','9756396','9757194','9757292','9757299','9757390','9758195','9758293','9758391','9759196','9759294','9759399','9760092','9760190','9760197','9760295','9761191','9761198','9761296','9761394','9762199','9762290','9762297','9762395','9763095','9763193','9763291','9763298','9763396','9764194','9764292','9764299','9764390','9764397','9765195','9765293','9765391','9765398','9766196','9766294','9766392','9767190','9767197','9767295','9768191','9768296','9768394','9769192','9769290','9769297','9770193','9770298','9770396','9771194','9771292','9771299','9771397','9772090','9772097','9772195','9772293','9772398','9773091','9773098','9773196','9773294','9773399','9774092','9774099','9774190','9774197','9774295','9775093','9775191','9775198','9775296','9776094','9776192','9776199','9776290','9776297','9777095','9777193','9777291','9777298','9777396','9778096','9778194','9778292','9778299','9778390','9779090','9779097','9779195','9779293','9780091','9780098','9780196','9780294','9780392','9780399','9781092','9781099','9781190','9781197','9781295','9781393','9782191','9782198','9782296','9783192','9783199','9783290','9783395','9784095','9784193','9784291','9784298','9784396','9785096','9785292','9785299','9785390','9786090','9786097','9786195','9786391','9786398','9787091','9787098','9787196','9787294','9787392','9787399','9788099','9788190','9788197','9788295','9788393','9789093','9789191','9789198','9789296','9789394','9790094','9790192','9790199','9790297','9790395','9791095','9791193','9791291','9791298','9791396','9792096','9792292','9792299','9792390','9792397','9793090','9793293','9794091','9794098','9794294','9794392','9794399','9795092','9795099','9795295','9796093','9796191','9796198','9796296','9797192','9797199','9797290','9797297','9797395','9798193','9798298','9799096','9799194','9799292','9799299','9717491','9749390','9700495','9734494','9717498','9713494','9722090','9730497','9762396','9796395','9709490','9726493','9709497','9792391','9741396','9788191','9792398','9737392','9771391','9722496','9769291','9767191','9788394','9786294','9718492','9701496','9767394','9718499','9750398','9731491','9729391','9714495','9746394','9708195','9763397','9797396','9710491','9727494','9710498','9776396','9723490','9793399','9706494','9772392','9723497','9785195','9772399','9719493','9751392','9736496','9734396','9732492','9764391','9715496','9798390','9745295','9732499','9764398','9798397','9711492','9743391','9741291','9777390','9728495','9760394','9711499','9794393','9709399','9743398','9724491','9722391','9756390','9707495','9739394','9773393','9724498','9722398','9703491','9790396','9737490','9718394','9786392','9703498','9737497','9735397','9769396','9716490','9786399','9733493','9731393','9799391','9716497','9727193','9782395','9799398','9778391','9729496','9761395','9795394','9778398','9725492','9791390','9740395','9738295','9725499','9757398','9791397','9736391','9721495','9732191','9764090','9751294','9787393','9704499','9702399','9758091','9728194','9777397','9785398','9676695','9679691','9700194','9700292','9700299','9700390','9700397','9701195','9701293','9701391','9701398','9702196','9702294','9702392','9702490','9702497','9703190','9703197','9703295','9703393','9704191','9704198','9704296','9704394','9704492','9705192','9705199','9705290','9705297','9705395','9705493','9706291','9706298','9706396','9707292','9707299','9707390','9707397','9708293','9708391','9708398','9709196','9709294','9709392','9710197','9710295','9710393','9711191','9711198','9711296','9711394','9712290','9712297','9712395','9712493','9713291','9713298','9713396','9714292','9714299','9714390','9714397','9715195','9715293','9715391','9715398','9716196','9716294','9716392','9716399','9717190','9717197','9717295','9717393','9718191','9718198','9718296','9719192','9719199','9719290','9719297','9719395','9720193','9720291','9720298','9720396','9721194','9721292','9721299','9721390','9721397','9722195','9722293','9723196','9723294','9723392','9723399','9724190','9724197','9724295','9724393','9725191','9725198','9725296','9725394','9726192','9726199','9726290','9726297','9726395','9727291','9727298','9727396','9728292','9728299','9728390','9728397','9729090','9729195','9729293','9729398','9730098','9730196','9730294','9730392','9730399','9730490','9731190','9731197','9731295','9731498','9732198','9732296','9732394','9733192','9733199','9733290','9733297','9733395','9734095','9734193','9734291','9734298','9735194','9735292','9735299','9735390','9735495','9736195','9736293','9736398','9737196','9737294','9737399','9738099','9738190','9738197','9738393','9739093','9739191','9739198','9739296','9740192','9740199','9740290','9740297','9741193','9741298','9742194','9742292','9742299','9742390','9742397','9743195','9743293','9744196','9744294','9744392','9744399','9745190','9745197','9745393','9746191','9746198','9746296','9747192','9747199','9747290','9747297','9747395','9748193','9748291','9748298','9748396','9749194','9749292','9749299','9749397','9750195','9750293','9750391','9751196','9751399','9752190','9752197','9752295','9752393','9753191','9753198','9753296','9753394','9754192','9754199','9754290','9754297','9754395','9755193','9755291','9755298','9755396','9756194','9756292','9756299','9756397','9757195','9757293','9757391','9758098','9758196','9758294','9758392','9758399','9759190','9759197','9759295','9759393','9760191','9760198','9760296','9761192','9761199','9761290','9761297','9762193','9762291','9762298','9763096','9763194','9763292','9763299','9763390','9764097','9764195','9764293','9765196','9765294','9765392','9765399','9766190','9766197','9766295','9766393','9767198','9767296','9768192','9768199','9768290','9768297','9768395','9769095','9769193','9769298','9770194','9770292','9770299','9770390','9770397','9771195','9771293','9771398','9772091','9772098','9772196','9772294','9773092','9773099','9773190','9773197','9773295','9774093','9774191','9774198','9774296','9774394','9775094','9775192','9775199','9775290','9775297','9775395','9776095','9776193','9776291','9776298','9777096','9777194','9777292','9777299','9778090','9778097','9778195','9778293','9779091','9779098','9779196','9779294','9779392','9779399','9780099','9780190','9780197','9780295','9780393','9781191','9781198','9781296','9782094','9782192','9782199','9782290','9782297','9783095','9783193','9783291','9783298','9783396','9784096','9784194','9784292','9784299','9784397','9785090','9785293','9785391','9786098','9786196','9787092','9787190','9787197','9787295','9788093','9788198','9788296','9789094','9789192','9789199','9789290','9789297','9789395','9790095','9790193','9790291','9790298','9791096','9791194','9791292','9791299','9792090','9792097','9792195','9792293','9793098','9793294','9793392','9794092','9794099','9794295','9795093','9795198','9795296','9796192','9796199','9796290','9796297','9797095','9797193','9797291','9798096','9798194','9798292','9798299','9799195','9799293')
and ixOrder IN (SELECT distinct ixOrder from tblOrderLine where sSKUNotInOptimalDC is NULL) -- 3,291



select sSKUNotInOptimalDC, count(1) -- 398
from tblOrderLine
where ixOrder in ('9700190','9700394','9700492','9703193','9704396','9705392','9705394','9706297','9707295','9707398','9708293','9710297','9711393','9712195','9712392','9714195','9714391','9714395','9716190','9716195','9716296','9716394','9716395','9716497','9717391','9717392','9718194','9718399','9719293','9720198','9720290','9720293','9720295','9720491','9721194','9721295','9721394','9721398','9721498','9722294','9722297','9722393','9723299','9724491','9724494','9725292','9725293','9725299','9725392','9725396','9725398','9726297','9727197','9727399','9727499','9728491','9729090','9729398','9730397','9731494','9732195','9732390','9733291','9733399','9734095','9735393','9736094','9738390','9738391','9739092','9740199','9740394','9741295','9741393','9742196','9742295','9742399','9744391','9747190','9747194','9747295','9747299','9750199','9750299','9751390','9752293','9752394','9753294','9753391','9754191','9754290','9755094','9755397','9757292','9758092','9758096','9758395','9759190','9759194','9759199','9762292','9762391','9765197','9765393','9767390','9767397','9769198','9769392','9769398','9772299','9772391','9772394','9773192','9773194','9773391','9775092','9775197','9775292','9775390','9776290','9776397','9776398','9777198','9778190','9778391','9779196','9779392','9779393','9780398','9782191','9782298','9783290','9784198','9785196','9785390','9786290','9786292','9787096','9788190','9788194','9793290','9794298','9795196','9797097')
group by sSKUNotInOptimalDC

9721295
9721398
9733399
9752293


-- ORDERS with no
SELECT distinct ixOrder FROM #AllNullOptimalDCflags
WHERE ixOptimalShipLocation <> ixPrimaryShipLocation -- 144

/*
You're file had 3,608 orders in it
  398 of them had at least 1 value in sSKUNotInOptimalDC
3,147 of them had ixOptimalShipLocation = ixPrimaryShipLocation 
  144 of them had no sSKUNotInOptimalDC values but the ixOptimalShipLocation <> ixPrimaryShipLocation 
*/



Select O.ixOrder, ixOptimalShipLocation, ixPrimaryShipLocation, 
    OL.ixSKU,     OL.sSKUNotInOptimalDC
from tblOrder O
    left join tblOrderLine OL on O.ixOrder = OL.ixOrder
WHERE O.ixOrder in ('9721295','9721398','9733399','9752293')
order by O.ixOrder, OL.ixSKU


select flgCARB, count(ixSKU)
from tblSKU
where flgDeletedFromSOP = 0
    and flgActive = 1
    and sCARBSubclass is NULL
group by flgCARB
