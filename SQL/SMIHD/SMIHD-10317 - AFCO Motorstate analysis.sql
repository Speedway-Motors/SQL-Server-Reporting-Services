-- SMIHD-10317 - AFCO Motorstate analysis

/************    BUILD SMI BASE TABLE    ************/
            USE [SMITemp]
            GO

            SET ANSI_NULLS ON
            GO

            SET QUOTED_IDENTIFIER ON
            GO

            CREATE TABLE [dbo].[PJC_SMIHD10317_SMISalesForAfcoSKUs](
	            [SMISKU] [varchar](30) NOT NULL,
	            [AFCOSKU] [varchar](30) NULL,
	            [SKUDescription] [varchar](500) NULL,
	            [RetailQtySold12Mo] [int] NULL,
	            [RetailPrice] [money] NULL,
	            [PRSQtySold12Mo] [int] NULL,
	            [PRSPlvl3] [money] NULL,
	            [CurrentVendorCost] [money] NULL
            ) ON [PRIMARY]
            GO
/************     POPULATE [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs   ************/
    -- DROP TABLE [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs
    INSERT INTO [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs
    SELECT S.ixSKU 'SMISKU' -- 14,113 SKUs on SMI side     13,757 match to AFCOReporting SKUs (97%)  
        , VS.sVendorSKU 'AFCOSKU'
        , ISNULL(S.sWebDescription,S.sDescription) 'SKUDescription' 
        , RETAIL.QtySold12Mo 'RetailQtySold12Mo'
        , S.mPriceLevel1 'RetailPrice'
        , PRS.QtySold12Mo 'PRSQtySold12Mo'
        , S.mPriceLevel3 'PRSPlvl3'
        , VS.mCost 'CurrentVendorCost'
    FROM tblSKU S
        JOIN tblVendorSKU VS on S.ixSKU = VS.ixSKU and VS.iOrdinality = 1
        JOIN tblVendor V on VS.ixVendor = V.ixVendor
        LEFT JOIN (-- 12 Mo Retail Sales
                    SELECT OL.ixSKU
                       -- , SUM(OL.mExtendedPrice) 'Sales12Mo'
                         , SUM(OL.iQuantity) AS 'QtySold12Mo'
                        -- , SUM(OL.mExtendedCost) 'CoGS12Mo'
                    FROM tblOrderLine OL 
                        JOIN tblOrder O on O.ixOrder = OL.ixOrder
                        JOIN tblDate D on D.dtDate = OL.dtOrderDate 
                    WHERE  OL.flgLineStatus IN ('Shipped','Dropshipped')
                        and O.sOrderStatus = 'Shipped'
                        and D.dtDate between '03/01/2017' and '02/28/2018' 
                        and O.sOrderType = 'Retail'
                    GROUP BY OL.ixSKU
                    ) RETAIL on RETAIL.ixSKU = S.ixSKU     
        LEFT JOIN (-- 12 Mo PRS Sales
                    SELECT OL.ixSKU
                       -- , SUM(OL.mExtendedPrice) 'Sales12Mo'
                        , SUM(OL.iQuantity) AS 'QtySold12Mo'
                        -- , SUM(OL.mExtendedCost) 'CoGS12Mo'
                    FROM tblOrderLine OL 
                        JOIN tblOrder O on O.ixOrder = OL.ixOrder
                        JOIN tblDate D on D.dtDate = OL.dtOrderDate 
                    WHERE  OL.flgLineStatus IN ('Shipped','Dropshipped')
                        and O.sOrderStatus = 'Shipped'
                        and D.dtDate between '03/01/2017' and '02/28/2018' 
                        and O.sOrderType = 'PRS'
                        and O.ixCustomer <> 1770000 -- exclude per CCC
                    GROUP BY OL.ixSKU
                    ) PRS on PRS.ixSKU = S.ixSKU  
        -- AFCO Reporting data below
    WHERE S.flgDeletedFromSOP = 0
        and S.flgActive = 1
        and V.ixVendor in ('0106','0108','0311','0313','0582') -- use for sure
                       --,'0111','0126','0136') -- CCC said to ignore these


SELECT COUNT(SMISKU) from [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs          -- 12795
SELECT COUNT(DISTINCT SMISKU) from [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs -- 12795




/************    BUILD AFCO MOTORSTATE SALES TABLE    ************/    
    USE [SMITemp]
    GO

    /****** Object:  Table [dbo].[PJC_SMIHD10317_AFCOMotorStateSales]    Script Date: 3/15/2018 12:50:53 PM ******/
    SET ANSI_NULLS ON
    GO

    SET QUOTED_IDENTIFIER ON
    GO

    CREATE TABLE [dbo].[PJC_SMIHD10317_AFCOMotorStateSales](
	    [AFCOSKU] [varchar](30) NULL,
	    [MOTORSTQtySold12Mo] [int] NULL,
	    [MS2017PL1] [money] NULL,
	    [AFCOAvgCost] [money] NULL,
        [AFCOPV] [varchar] (10) NULL,
        [AFCOPVName] [varchar](30) NULL
    ) ON [PRIMARY]
    GO





/************     POPULATE [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales    ************/  
    -- DROP TABLE [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales             
    INSERT INTO [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales 
    SELECT OL.ixSKU 'AFCOSKU'  -- 898
        --, SUM(OL.mExtendedPrice) 'MOTORSTSales12Mo'
        , SUM(OL.iQuantity) AS 'MOTORSTQtySold12Mo'
        , CD.mPriceLevel1 'MS2017PL1'
        , S.mAverageCost 'AFCOAvgCost'
        , VS.ixVendor 'AFCOPV'
        , V.sName 'AFCOPVName'
        -- , SUM(OL.iQuantity) AS 'QtySold12Mo'
        -- , SUM(OL.mExtendedCost) 'CoGS12Mo'

    FROM [AFCOReporting].dbo.tblOrderLine OL 
        JOIN [AFCOReporting].dbo.tblOrder O on O.ixOrder = OL.ixOrder
        JOIN [AFCOReporting].dbo.tblDate D on D.dtDate = OL.dtOrderDate 
        JOIN [AFCOReporting].dbo.tblSKU S on S.ixSKU = OL.ixSKU
        JOIN [AFCOReporting].dbo.tblVendorSKU VS on S.ixSKU = VS.ixSKU and VS.iOrdinality = 1
        JOIN [AFCOReporting].dbo.tblVendor V on VS.ixVendor = V.ixVendor
       left join [AFCOReporting].dbo.tblCatalogDetail CD on CD.ixSKU = S.ixSKU and CD.ixCatalog = 'MS2017'
    WHERE  OL.flgLineStatus IN ('Shipped','Dropshipped')
        and D.dtDate between '03/01/2017' and '02/28/2018' --DATEADD(yy, -1, getdate()) and getdate() -- 1 YR AGO and TODAY
        and O.ixCustomer IN('10164','34799','10704','53012')
        and S.flgDeletedFromSOP = 0
        and S.flgActive = 1
        AND O.sOrderStatus = 'Shipped'
        AND V.ixVendor NOT between '0040' and '0047'
        and V.ixVendor NOT IN ('7892','5302','6479','5012','5631','0999')
        --and O.sOrderType = 'PRS'
    GROUP BY VS.ixVendor, V.sName, OL.ixSKU, CD.mPriceLevel1 , S.mAverageCost
    order by VS.ixVendor -- SUM(OL.mExtendedPrice) desc

 
SELECT COUNT(AFCOSKU) from [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales          -- 898
SELECT COUNT(DISTINCT AFCOSKU) from [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales -- 898

SELECT COUNT(AFCOSKU) FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales
where AFCOSKU IN (SELECT AFCOSKU FROM [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs) --  779

SELECT SUM(MOTORSTQtySold12Mo) Sales
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales                                       -- 14350
where AFCOSKU NOT IN (SELECT AFCOSKU FROM [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs) --   733,106

SELECT * FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales  
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales                                   -- 1,435,796

SELECT AFCOSKU FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales                    -- 779
WHERE AFCOSKU IN (SELECT AFCOSKU FROM [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs)
ORDER BY MOTORSTQtySold12Mo DESC



SELECT count(distinct AFCOSKU) 
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales   -- 898

SELECT *
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales   
WHERE AFCOSKU NOT IN (SELECT AFCOSKU 
                  FROM [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs) -- 816

SELECT *
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales   
WHERE AFCOSKU NOT IN (SELECT AFCOSKU 
                      FROM [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs) -- 0



SELECT A.*, B.AFCOSKU
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales A 
LEFT join  [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs B on A.AFCOSKU = B.AFCOSKU
WHERE B.AFCOSKU is NULL
ORDER BY B.AFCOSKU, MOTORSTQtySold12Mo DESC 


select distinct ixVendor from tblVendorSKU where sVendorSKU in ('52-72593','40000','52-72715','52-44391','52-78260','A960B','52-72582','52-79501','52-44467','52-79800','52-72613','52-78298','52-56801','52-53000','52-44470','52-11150','52-44463','A750B','52-46540','52-56797','52-68604','52-44460','52-53003','20095','TA760','52-79005','52-22548','52-52024','27005B','52-32700','52-56605','52-72726','52-73511','52-56838','52-44473','52-46545','52-44475','52-50682','52-72292','52-22530','52-22534','52-44390','52-50100','52-78290','52-44461','52-44479','A950B','52-65130','52-52004','52-50546','52-72304','52-77750','52-53050','52-21730','52-72675','52-45420','52-45750','52-52001','52-50640','52-44124','52-73500','52-46516','52-78295','52-73014','52-50473','52-50887','52-52031','52-52034','52-53010','52-50553','52-73010','TA750','52-44430','52-56841','52-72728','52-61040','52-50690','52-78311','52-79015','52-68602','52-53036','52-72983','Z902','52-44867','52-53008','52-53006','52-79620','52-52033','52-65182','AC740B','52-44384','52-44477','52-32702','52-61150','52-22549','52-32750','52-56833','52-44869','52-44381','52-45490','52-50547','52-45753','52-43520','52-45760','TA7510','52-50650','52-50316','52-61070','52-72717','52-44402','3850BGX','52-43250','TA746','52-22547','52-78325','TA7611','52-72831','52-45470','DROP5','52-68618','52-50620','AC746B','52-61015','52-46535','20090','74-7-3-8','52-78272','52-45460','52-61050','52-53053','TA767','TA7414','52-22538','52-78273','52-52000','52-61170','52-23708','52-52021','52-46555','52-52011','52-79610','52-45784','52-56820','52-56837','52-78430','52-50556','52-72900','52-44445','52-1601470','52-72842','A745B','A947B','A946B','52-61041','52-72875','52-79630','52-22551','74-7-4-6','52-50000','52-78405','52-56830','20187','52-50846','52-72840','ASB637B','52-22535','52-45423','52-50840','52-45462','52-78250','52-50612','52-52023','52-44134','52-50750','52-46553','52-52002','52-44440','52-50870','52-72537','52-22164','52-43500','52-50493','52-40141','52-50730','AC550B','AC757B','C520','52-44866','52-65162','52-79622','52-50315','52-45216','A753B','52-52013','75-7-3-6','74-9-4-4','52-11152','52-44535','52-79505','52-22539','52-2708685','52-46550','52-M72593','52-11154','52-56811','TA7514','TA7410','52-43241','52-45748','52-61140','52-72905','52-32752','52-M72582','52-72624','3270BGX','3260BGX','74-9-8-2','52-61010','52-43510','52-52053','AC950B','AC750B','52-22572','52-1601485','52-45466','A650B','52-61005','TA730','TA7512','52-44863','52-32730','52-78264','715-76010','52-43252','52-22553','TASS1004610','74-7-3-7','74-9-3-4','52-50240','52-78424','52-72870','52-22556','52-78320','52-32732','75-9-3-3','52-44108','715-75510','SS400','52-2708638','52-45783','A762B','A940B','TASS1004511','52-56800','52-45202','52-46511','C200/GM300','52-903169','52-22615','52-44865','52-45749','52-50615','52-44443','52-45792','52-2708665','52-52032','52-23706','TA763','TA740','52-50853','52-22537','52-68526','52-11156','ASB636B','52-52012','52-28050','52-50565','3860SP','52-45215','20173','52-56809','52-61051','52-45624','52-40000','AC940B','A945B','A838B','52-44145','52-56867','52-78318','52-43080','74-9-9-2','52-43021','52-22576','TA759','52-22532','52-52003','52-40100','52-22577','52-43505','TASS100453','52-50560','52-50483','75-7-3-8','75-9-3-4','715-76020','52-22540','52-72850','52-52022','52-78310','20185-1','52-72961','52-45273','52-56890','52-50265','52-46506','ASB635B','C353','52-40150','52-44431','52-44441','AC946B','AC760B','52-72896','22125CR','A746B','A848B','52-61016','52-50745','52-78262','77-9-8-2','77-7-4-6','TA757','52-56835','6640139','52-45780','TASS201840','TASS100470','52-44861','52-40152','52-45789','52-43000','52-45620','52-22570','10821','52-52063','715-75520','52-50884','52-44510','52-79121','22150CR','74-9-6-3','52-44930','52-22787','52-45430','52-64150','52-22321','SS402','20185','50200','52-11175','52-65692','24125CR','24110CR','52-44147','ASB/SR4ABP','52-22536','TA768','52-64320','TA758','TA992','TA735','52-78410','52-45900','TASS100435','TASS200872','TASS200840','52-56826','AC738B','ASB630B','B212','52-50886','52-22783','52-78414','52-72280','AC935B','AC730B','52-56600','52-22544','52-72988','A646B','A9310B','A849B','C352','52-73025','52-56825','52-3208920','74-9-3-5','74-7-5-5','74-7-3-6','52-50683','52-78291','52-32720','52-52009','28450-1CR','52-1401280','52-50557','52-22533','23300CR','52-73509','30052','52-45370','52-22589','52-23510','52-46521','TA9600','52-22601','52-32710','52-50747','TA935','52-50642','52-43600','77-7-4-4','52-56805','52-78242','715-75530','52-45040','TASS200862','TASS201846','S512/514','52-79753','52-23740','52-45030','30201','52-22569','52-41802','B212-1','52-50290','52-68525','52-50270','74-7-5-3','52-68620','52-23702','52-78428','52-1401305','52-45263','22200CR','52-56899','52-44871','52-50301','80061','52-22541','AC953B','52-43350','52-43020','711-35811','52-40250','52-48000','ASB734B','ASB732B','ASB741B','ASB726B','ASB634B','5500007402','52-78412','AC954B','AC646B','AC530B','AC759B','AC791B','AC7414B','AC754B','52-44411','52-68528','A938B','A653B','A956B','1379-7T','23550CR','52-45200','52-45440','701-13311','52-78240','52-22559','52-72550','52-22755','52-73502','52-45700','23200CR','52-44109','52-56829','52-1601465','52-43530','52-45220','Z903','52-2908730','52-45020','52-56908','TASS100450','24250B','52-46538','TA9510','TA739','TA958','TA956','TA700','52-56803','52-72890','52-41803','AC1007','TASS100459','TASS201872','TASS201835','TASS200835','TASS200853','TASS1004510','TASS200846','52-45720','TASS100437','TASS100473','52-46150','TASB739','TASB750','80312-15','74-9-7-2','73-7-3-8','73-7-5-5','74-9-5-3','74-9-7-3','74-7-4-5','52-45740','52-32500','52-45680','52-22568','52-50220','23115CR','22110CR','24150CR','22095CR','2011-1912','28300-1CR','52-50875','C303','B210','52-22757','52-50740','52-79751','52-50518','52-50496','52-50272','A700500136','52-40350','52-64360','52-48050','52-22162','52-43400','52-41801','52-43534','52-79020','550190031','52-78445','52-72894','52-78244','52-73503','776-24302','52-45660','52-56851','52-2708675','HELP','52-79019','52-45286','52-56866','52-50820','52-43536','S506','52-22528','20235','52-50512','52-LA-SERVICE','52-23720','52-47000','23500CR','52-42300','20244','52-45230','52-50008','52-MISC','52-33320','52-50883','52-22550','52-1101125','52-22613','52-44110','C361-10','C362-10','A550010327B','550000665','52-44153','52-43532','52-52093','52-45233','52-23780','52-23710','52-45754','52-64420','C378-10','55000029262','85282','52-72556','52-1101145','TA2007','52-56834','52-72989','52-2708647','550000050','550010381B','C354','52-2708635','89086-XXL','52-41805','SK1008','52-73013','31024','52-65885','80050','52-50274','52-32707','20131A-2','52-47840','C321','55000079310-4','55000029270','800-12-45-1.75','61-3SET','52-45300','52-50885','B211','CHBB3','52-1401350','MT59080-1','52-50497','0000626.3','52-23600','A550010136X','CMBB4','BPBB20','52-50498','A901070006X','A901060022X','52-72831-1','AFCO2017DRAG','SHOCKTICKET','52-72905-2','RADIATORTICKET','PRO2017','52-11800','52-72842-1','MONROE','NOEMAIL','52-72842-2','AFCO2018','DROPNC','52-72905-1','DT2017','52-72831-2','52-903621','CSIFF','52-11821','PLONLY','ASSEMBLYTICKET','WARRANTY','PROMOFF','52-901553','RULESFF','52-11950','AFCO2017','52-11920','PSHOCKTICKET','COMPLETE','READNOTE')
and iOrdinality = 1


select distinct ixVendor from tblVendorSKU where sVendorSKU in ('52-72593','40000','52-72715','52-44391','52-78260','A960B','52-72582','52-79501','52-44467','52-79800','52-72613','52-78298','52-56801','52-53000','52-44470','52-11150','52-44463','A750B','52-46540','52-56797','52-68604','52-44460','52-53003','20095','TA760','52-79005','52-22548','52-52024','27005B','52-32700','52-56605','52-72726','52-73511','52-56838','52-44473','52-46545','52-44475','52-50682','52-72292','52-22530','52-22534','52-44390','52-50100','52-78290','52-44461','52-44479','A950B','52-65130','52-52004','52-50546','52-72304','52-77750','52-53050','52-21730','52-72675','52-45420','52-45750','52-52001','52-50640','52-44124','52-73500','52-46516','52-78295','52-73014','52-50473','52-50887','52-52031','52-52034','52-53010','52-50553','52-73010','TA750','52-44430','52-56841','52-72728','52-61040','52-50690','52-78311','52-79015','52-68602','52-53036','52-72983','Z902','52-44867','52-53008','52-53006','52-79620','52-52033','52-65182','AC740B','52-44384','52-44477','52-32702','52-61150','52-22549','52-32750','52-56833','52-44869','52-44381','52-45490','52-50547','52-45753','52-43520','52-45760','TA7510','52-50650','52-50316','52-61070','52-72717','52-44402','3850BGX','52-43250','TA746','52-22547','52-78325','TA7611','52-72831','52-45470','DROP5','52-68618','52-50620','AC746B','52-61015','52-46535','20090','74-7-3-8','52-78272','52-45460','52-61050','52-53053','TA767','TA7414','52-22538','52-78273','52-52000','52-61170','52-23708','52-52021','52-46555','52-52011','52-79610','52-45784','52-56820','52-56837','52-78430','52-50556','52-72900','52-44445','52-1601470','52-72842','A745B','A947B','A946B','52-61041','52-72875','52-79630','52-22551','74-7-4-6','52-50000','52-78405','52-56830','20187','52-50846','52-72840','ASB637B','52-22535','52-45423','52-50840','52-45462','52-78250','52-50612','52-52023','52-44134','52-50750','52-46553','52-52002','52-44440','52-50870','52-72537','52-22164','52-43500','52-50493','52-40141','52-50730','AC550B','AC757B','C520','52-44866','52-65162','52-79622','52-50315','52-45216','A753B','52-52013','75-7-3-6','74-9-4-4','52-11152','52-44535','52-79505','52-22539','52-2708685','52-46550','52-M72593','52-11154','52-56811','TA7514','TA7410','52-43241','52-45748','52-61140','52-72905','52-32752','52-M72582','52-72624','3270BGX','3260BGX','74-9-8-2','52-61010','52-43510','52-52053','AC950B','AC750B','52-22572','52-1601485','52-45466','A650B','52-61005','TA730','TA7512','52-44863','52-32730','52-78264','715-76010','52-43252','52-22553','TASS1004610','74-7-3-7','74-9-3-4','52-50240','52-78424','52-72870','52-22556','52-78320','52-32732','75-9-3-3','52-44108','715-75510','SS400','52-2708638','52-45783','A762B','A940B','TASS1004511','52-56800','52-45202','52-46511','C200/GM300','52-903169','52-22615','52-44865','52-45749','52-50615','52-44443','52-45792','52-2708665','52-52032','52-23706','TA763','TA740','52-50853','52-22537','52-68526','52-11156','ASB636B','52-52012','52-28050','52-50565','3860SP','52-45215','20173','52-56809','52-61051','52-45624','52-40000','AC940B','A945B','A838B','52-44145','52-56867','52-78318','52-43080','74-9-9-2','52-43021','52-22576','TA759','52-22532','52-52003','52-40100','52-22577','52-43505','TASS100453','52-50560','52-50483','75-7-3-8','75-9-3-4','715-76020','52-22540','52-72850','52-52022','52-78310','20185-1','52-72961','52-45273','52-56890','52-50265','52-46506','ASB635B','C353','52-40150','52-44431','52-44441','AC946B','AC760B','52-72896','22125CR','A746B','A848B','52-61016','52-50745','52-78262','77-9-8-2','77-7-4-6','TA757','52-56835','6640139','52-45780','TASS201840','TASS100470','52-44861','52-40152','52-45789','52-43000','52-45620','52-22570','10821','52-52063','715-75520','52-50884','52-44510','52-79121','22150CR','74-9-6-3','52-44930','52-22787','52-45430','52-64150','52-22321','SS402','20185','50200','52-11175','52-65692','24125CR','24110CR','52-44147','ASB/SR4ABP','52-22536','TA768','52-64320','TA758','TA992','TA735','52-78410','52-45900','TASS100435','TASS200872','TASS200840','52-56826','AC738B','ASB630B','B212','52-50886','52-22783','52-78414','52-72280','AC935B','AC730B','52-56600','52-22544','52-72988','A646B','A9310B','A849B','C352','52-73025','52-56825','52-3208920','74-9-3-5','74-7-5-5','74-7-3-6','52-50683','52-78291','52-32720','52-52009','28450-1CR','52-1401280','52-50557','52-22533','23300CR','52-73509','30052','52-45370','52-22589','52-23510','52-46521','TA9600','52-22601','52-32710','52-50747','TA935','52-50642','52-43600','77-7-4-4','52-56805','52-78242','715-75530','52-45040','TASS200862','TASS201846','S512/514','52-79753','52-23740','52-45030','30201','52-22569','52-41802','B212-1','52-50290','52-68525','52-50270','74-7-5-3','52-68620','52-23702','52-78428','52-1401305','52-45263','22200CR','52-56899','52-44871','52-50301','80061','52-22541','AC953B','52-43350','52-43020','711-35811','52-40250','52-48000','ASB734B','ASB732B','ASB741B','ASB726B','ASB634B','5500007402','52-78412','AC954B','AC646B','AC530B','AC759B','AC791B','AC7414B','AC754B','52-44411','52-68528','A938B','A653B','A956B','1379-7T','23550CR','52-45200','52-45440','701-13311','52-78240','52-22559','52-72550','52-22755','52-73502','52-45700','23200CR','52-44109','52-56829','52-1601465','52-43530','52-45220','Z903','52-2908730','52-45020','52-56908','TASS100450','24250B','52-46538','TA9510','TA739','TA958','TA956','TA700','52-56803','52-72890','52-41803','AC1007','TASS100459','TASS201872','TASS201835','TASS200835','TASS200853','TASS1004510','TASS200846','52-45720','TASS100437','TASS100473','52-46150','TASB739','TASB750','80312-15','74-9-7-2','73-7-3-8','73-7-5-5','74-9-5-3','74-9-7-3','74-7-4-5','52-45740','52-32500','52-45680','52-22568','52-50220','23115CR','22110CR','24150CR','22095CR','2011-1912','28300-1CR','52-50875','C303','B210','52-22757','52-50740','52-79751','52-50518','52-50496','52-50272','A700500136','52-40350','52-64360','52-48050','52-22162','52-43400','52-41801','52-43534','52-79020','550190031','52-78445','52-72894','52-78244','52-73503','776-24302','52-45660','52-56851','52-2708675','HELP','52-79019','52-45286','52-56866','52-50820','52-43536','S506','52-22528','20235','52-50512','52-LA-SERVICE','52-23720','52-47000','23500CR','52-42300','20244','52-45230','52-50008','52-MISC','52-33320','52-50883','52-22550','52-1101125','52-22613','52-44110','C361-10','C362-10','A550010327B','550000665','52-44153','52-43532','52-52093','52-45233','52-23780','52-23710','52-45754','52-64420','C378-10','55000029262','85282','52-72556','52-1101145','TA2007','52-56834','52-72989','52-2708647','550000050','550010381B','C354','52-2708635','89086-XXL','52-41805','SK1008','52-73013','31024','52-65885','80050','52-50274','52-32707','20131A-2','52-47840','C321','55000079310-4','55000029270','800-12-45-1.75','61-3SET','52-45300','52-50885','B211','CHBB3','52-1401350','MT59080-1','52-50497','0000626.3','52-23600','A550010136X','CMBB4','BPBB20','52-50498','A901070006X','A901060022X','52-72831-1','AFCO2017DRAG','SHOCKTICKET','52-72905-2','RADIATORTICKET','PRO2017','52-11800','52-72842-1','MONROE','NOEMAIL','52-72842-2','AFCO2018','DROPNC','52-72905-1','DT2017','52-72831-2','52-903621','CSIFF','52-11821','PLONLY','ASSEMBLYTICKET','WARRANTY','PROMOFF','52-901553','RULESFF','52-11950','AFCO2017','52-11920','PSHOCKTICKET','COMPLETE','READNOTE')
and iOrdinality = 1

select * from tblVendor where ixVendor in ('0001','0009','0108','0111','0201','0326','0427','0475','0476','0578','0603','1311','1625','1729','2527','2895','2920','3710','9106')


-- FINAL DATA FOR SPREADSHEET
SELECT SMI.SMISKU
    ,SMI.AFCOSKU
    ,SMI.SKUDescription	
    ,ISNULL(SMI.RetailQtySold12Mo,0) 'RetailQtySold12Mo' 
    ,SMI.RetailPrice	
    ,ISNULL(SMI.PRSQtySold12Mo,0) 'PRSQtySold12Mo'
    ,SMI.PRSPlvl3	
    ,SMI.CurrentVendorCost	
   -- ,SMI.MatchingAFCOSKU
    ,ISNULL(AFCO.MOTORSTQtySold12Mo,0) 'MOTORSTQtySold12Mo'
    ,AFCO.MS2017PL1	
    ,AFCO.AFCOAvgCost
    ,AFCO.AFCOSKU		
    ,AFCO.AFCOPV
    ,AFCO.AFCOPVName
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales AFCO
LEFT JOIN [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs SMI ON AFCO.AFCOSKU = SMI.AFCOSKU

-- verify total against spreadsheet totals
SELECT SUM(RetailQtySold12Mo) TOTRetailQtySold12Mo,
    SUM(PRSQtySold12Mo) TOTPRSQtySold12Mo,
    SUM(MOTORSTQtySold12Mo) TOTMOTORSTQtySold12Mo
FROM [SMITemp].dbo.PJC_SMIHD10317_AFCOMotorStateSales AFCO
LEFT JOIN [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs SMI ON AFCO.AFCOSKU = SMI.AFCOSKU
/*
TOTRetailQtySold12Mo	TOTPRSQtySold12Mo	TOTMOTORSTQtySold12Mo
16990	                4223	            14350

100% match to spreadsheet totals
*/
select * from [SMITemp].dbo.PJC_SMIHD10317_SMISalesForAfcoSKUs
