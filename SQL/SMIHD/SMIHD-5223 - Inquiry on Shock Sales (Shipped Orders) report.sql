-- SMIHD-5223 - Inquiry on Shock Sales (Shipped Orders) report

SELECT ixOrder, sOrderStatus, dtDateLastSOPUpdate, ixTimeLastSOPUpdate
FROM tblOrder
where ixOrder = '6662189'
/*
ixOrder	sOrderStatus	dtDateLastSOPUpdate	ixTimeLastSOPUpdate
6662189	Open	        2016-08-17          26051
*/
SELECT * FROM tblOrderLine
where ixOrder = '6662189'
/*
SKU Product Group Code	PGC Description	SKU	SKU Description	Retail	ixOrder	Actual Units Sold	Sales	Cost of Goods
kI	SHOCK INVENTORY	10674-7-4-5	AFCO 74 SERIES SHOCK	119.99	6655187	1	69.99	80.29
kI	SHOCK INVENTORY	10674-7-4-7	AFCO 74 SERIES SHOCK	119.99	6655187	1	69.99	80.29
kI	SHOCK INVENTORY	10674-9-8-3	AFCO 74 SERIES SHOCK	119.99	6655187	1	69.99	80.29
kI	SHOCK INVENTORY	213LR-20-70-0	CUSTOM LR COB BILSTEIN	134.99	6644185	1	114.98	62.01
kI	SHOCK INVENTORY	10674-7-3-6	AFCO 74 SERIES SHOCK	119.99	6655187	1	69.99	80.29
kI	SHOCK INVENTORY	10674-9-3-4	AFCO 74 SERIES SHOCK	119.99	6655187	1	69.99	80.29
kQ	QA1 - SHOCK REBUILD	721RK10	QA1 16,26,28 REBUILD KITS	21.99	6644185	1	17.98	15.48
kQ	QA1 - SHOCK REBUILD	DYNO-QA1	DYNO SHOCK SERVICE	10.00	6644185	10	59.70	0.01
kQ	QA1 - SHOCK REBUILD	SHOCKRB-QA1	SHOCK REBUILD	0.00	6644185	12	0.00	0.00
kQ	QA1 - SHOCK REBUILD	7219000	SHOCK REPAIR	34.99	6644185	2	49.96	0.00
kQ	QA1 - SHOCK REBUILD	7219054321	GLAND	20.99	6644185	1	18.98	13.43
kR	AFCO SHOCK - REBUILD PARTS	SHOCKRB-AFCO	SHOCK REBUILD	0.00	6522986	2	0.00	0.032
kR	AFCO SHOCK - REBUILD PARTS	A550070136	SHAFT, 6IN SB DFL DSK SHORT	19.99	6522986	2	39.98	25.62
kR	AFCO SHOCK - REBUILD PARTS	90007	REPAIR/REVALVE NON ADJ	39.99	6522986	2	79.98	3.676
kS	BILSTEIN SHOCK - REBUILD PARTS	21340110	ROD GUIDE ASSEMBLY	21.99	6644185	5	88.40	84.00
kS	BILSTEIN SHOCK - REBUILD PARTS	DYNO-BIL	DYNO SHOCK SERVICE	10.00	6644185	1	5.97	0.001
kS	BILSTEIN SHOCK - REBUILD PARTS	4941000	SHOCK REPAIR	34.99	6644185	1	22.98	0.00
kS	BILSTEIN SHOCK - REBUILD PARTS	21340160	46mm TEFLON PISTON BAND	1.89	6644185	5	8.40	6.35
kS	BILSTEIN SHOCK - REBUILD PARTS	21340120	9" BILSTEIN SHAFT	31.99	6644185	1	26.98	24.67
kS	BILSTEIN SHOCK - REBUILD PARTS	4942000	REVALVE SHOCK	39.99	6644185	4	111.92	0.00
*/


SELECT ixOrder, sOrderStatus, dtDateLastSOPUpdate, ixTimeLastSOPUpdate
FROM tblOrder
where ixOrder = '6655187'
/*
ixOrder	sOrderStatus	dtDateLastSOPUpdate	ixTimeLastSOPUpdate
6655187	Shipped	2016-08-17 00:00:00.000	26542
*/
SELECT * FROM tblOrderLine
where ixOrder = '6655187'
/*
ixOrder	ixCustomer	ixSKU	ixShippedDate	ixOrderDate	iQuantity	mUnitPrice	mExtendedPrice	flgLineStatus	dtOrderDate	dtShippedDate	mCost	mExtendedCost	flgKitComponent	iOrdinality	iKitOrdinality	ixPrintedDate	ixPrintedTime	mSystemUnitPrice	mExtendedSystemPrice	ixPriceDevianceReasonCode	sPriceDevianceReason	ixPicker	sTrackingNumber	iMispullQuantity	dtDateLastSOPUpdate	ixTimeLastSOPUpdate	flgOverride
6655187	471845	10674-7-3-6	17761	17761	1	69.99	69.99	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	0	1	1	17761	54698	119.99	119.99	2000	PROMOTION/LETS MAKE A DEAL	NULL	NULL	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	74-7-PB-PB	17761	17761	1	0.00	0.00	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	1	2	1	17761	54698	0.00	0.00	2000	PROMOTION/LETS MAKE A DEAL	NULL	280335870121918	0	2016-08-17 00:00:00.000	26542	1
6655187	471845	10674-7-4-7	17761	17761	1	69.99	69.99	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	0	3	3	17761	54698	119.99	119.99	2000	PROMOTION/LETS MAKE A DEAL	NULL	NULL	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	74-7-PB-PB	17761	17761	1	0.00	0.00	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	1	4	3	17761	54698	0.00	0.00	2000	PROMOTION/LETS MAKE A DEAL	NULL	280335870121918	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	10674-7-4-5	17761	17761	1	69.99	69.99	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	0	5	5	17761	54698	119.99	119.99	2000	PROMOTION/LETS MAKE A DEAL	NULL	NULL	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	74-7-PB-PB	17761	17761	1	0.00	0.00	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	1	6	5	17761	54698	0.00	0.00	2000	PROMOTION/LETS MAKE A DEAL	NULL	280335870121918	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	10674-9-3-4	17761	17761	1	69.99	69.99	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	0	7	7	17761	54698	119.99	119.99	2000	PROMOTION/LETS MAKE A DEAL	NULL	NULL	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	74-9-PB-PB	17761	17761	1	0.00	0.00	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	1	8	7	17761	54698	0.00	0.00	2000	PROMOTION/LETS MAKE A DEAL	NULL	280335870121918	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	10674-9-8-3	17761	17761	1	69.99	69.99	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	0	9	9	17761	54698	119.99	119.99	2000	PROMOTION/LETS MAKE A DEAL	NULL	NULL	0	2016-08-17 00:00:00.000	26542	0
6655187	471845	74-9-PB-PB	17761	17761	1	0.00	0.00	Shipped	2016-08-16 00:00:00.000	2016-08-16 00:00:00.000	80.29	80.29	1	10	9	17761	54698	0.00	0.00	2000	PROMOTION/LETS MAKE A DEAL	NULL	280335870121918	0	2016-08-17 00:00:00.000	26542	0
*/



DECLARE
    @Start_Date datetime,
    @End_Date datetime

SELECT
    @Start_Date = '08/16/16',
    @End_Date = '08/16/16'  

select
	SKU.ixPGC as 'SKU Product Group Code',
	PGC.sDescription as 'PGC Description',
	SKU.ixSKU as 'SKU', 
	SKU.sDescription as 'SKU Description',
	SKU.mPriceLevel1 as 'Retail',
    OL.ixOrder,
	sum(OL.iQuantity) as 'Actual Units Sold',
	sum(OL.mExtendedPrice) as 'Sales',
	sum(OL.mExtendedCost) as 'Cost of Goods'
from
	tblOrderLine OL
	right join vwSKULocalLocation SKU on OL.ixSKU = SKU.ixSKU
	right join tblPGC PGC on SKU.ixPGC = PGC.ixPGC
	left join tblOrder O on OL.ixOrder = O.ixOrder
where			
	OL.flgLineStatus in ('Shipped', 'Dropshipped')
	and (O.sOrderType <> 'Internal')
	and OL.dtShippedDate >= @Start_Date
	and OL.dtShippedDate < @End_Date+1
                and OL.flgKitComponent = 0 -- KIT COMPONENT CHECK
	and substring(SKU.ixPGC,1,1) in ('k') -- all the lower case values for the 1st char of ixPGC
group by
	SKU.ixPGC,
	PGC.sDescription,
	SKU.ixSKU,
	SKU.sDescription,
	SKU.mPriceLevel1,OL.ixOrder	
	
order by SKU.ixPGC



 
 
 
