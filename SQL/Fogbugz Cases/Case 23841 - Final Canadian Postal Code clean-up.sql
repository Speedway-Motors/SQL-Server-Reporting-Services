-- Case 23841 - Final Canadian Postal Code clean-up

/* status of customers that CLC is supposed
 to provide complete mailing info to Philip
 */
 
 select ixCustomer, sMailToState, sMailToZip from tblCustomer
where ixCustomer in ('1239882','1268781','1167380','1049788','1996771','1966075','1826679','1731774','1646573','1500678','1546373','1536377','1483775','1390673','1304670','1392274','1387275','1285972','1247979','1240570','1010579','1668866','1423766','1263161','1924055','1547555','1339049','1267947','1626026','1105129','1058020','901527','126048','126189')
order by sMailToZip









select distinct C.ixCustomer,sCustomerFirstName 'FirstName', sCustomerLastName 'LastName', sCustomerType,
  sMailToCity, sMailToState, sMailToZip, sMailToCountry, dtAccountCreateDate  
from tblCustomer C
    join tblOrder O on C.ixCustomer = O.ixCustomer
where flgDeletedFromSOP = 0 
and sMailToCountry = 'CANADA'
and sMailToZip = 'F'
order by dtAccountCreateDate desc


select sMailToCountry, COUNT(*)
from tblCustomer
where flgDeletedFromSOP = 0 
--and sMailToCountry = 'CANADA'
and sMailToZip = 'F'
group by sMailToCountry
order by  COUNT(*) desc
/*
2026	AUSTRALIA
871	NEW ZEALAND
825	SWEDEN
546	UNITED KINGDOM
475	GERMANY
459	FRANCE
345	NORWAY
222	FINLAND
218	JAPAN
184	BRAZIL
168	SWITZERLAND
147	NETHERLANDS
142	MEXICO
136	DENMARK
113	SOUTH AFRICA
112	ENGLAND
93	SPAIN
85	ITALY
68	BELGIUM
68	AUSTRIA
43	CHILE
43	IRELAND
40	INDONESIA
37	ARGENTINA
34	CANADA
29	UK
28	SINGAPORE
25	GREECE
22	THAILAND
21	HONG KONG
20	COLOMBIA
20	RUSSIA
19	POLAND
19	GREAT BRITAIN
18	ISRAEL
18	TRINIDAD
17	MALAYSIA
16	BARBADOS
15	VENEZUELA
15	UNITED ARAB EMIRATES
14	TURKEY
14	TAIWAN
14	INDIA
14	HOLLAND
13	PHILIPPINES
12	PORTUGAL
12	HUNGARY
12	KUWAIT
12	ARUBA
11	LUXEMBOURG
10	PERU
9	SCOTLAND
9	MALTA
9	CHINA
8	COSTA RICA
8	CZECH REPUBLIC
8	ICELAND
8	JAMAICA
8	GUATEMALA
7	NULL
7	SAUDI ARABIA
7	SOUTH KOREA
6	PANAMA
6	ESTONIA
5	DOMINICAN REPUBLIC
5	BAHAMAS
5	UKRAINE
4	PUERTO RICO
4	QATAR
4	BAHRAIN
4	ECUADOR
4	CROATIA
4	CYPRUS
4	LEBANON
4	NETHERLANDS ANTILLES
3	NIGERIA
3	BULGARIA
3	PARAGUAY
3	UAE
2	URUGUAY
2	PAKISTAN
2	BERMUDA
2	CAYMAN ISLANDS
2	EGYPT
2	EL SALVADOR
2	NORTHERN IRELAND
2	NEW CALEDONIA
2	LITHUANIA
2	HAITI
1	GRENADA
1	GUADELOUPE
1	GUAM
1	IRAN
1	JORDAN
1	KAZAKHSTAN
1	MONGOLIA
1	MOROCCO
1	OMAN
1	COTE D'IVOIRE
1	FIJI
1	GHANA
1	BOLIVIA
1	BELARUS
1	ROMANIA
1	SLOVENIA
1	VANUATU
1	YUGOSLAVIA
1	ZAMBIA
1	ST MARTIN
*/

select * from tblCanadianProvince


 

